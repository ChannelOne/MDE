"use strict";
const model_1 = require("../model");
const assert = require("assert");
const testText1 = `# Title

paragraph 1
something else

- first line
- second line
- third line`;
const multilinesText = `multilinesText
total 3 lines
last line.`;
let testLines1 = testText1.split("\n");
assert.equal(testLines1.length, 8);
console.log("Intialize testing...");
(() => {
    let tm1 = new model_1.TextModel(testText1);
    assert(tm1.linesCount === 8);
    tm1.forEach((line) => {
        let lineText = testLines1[line.number - 1];
        if (line.number != tm1.linesCount)
            lineText += "\n";
        assert(lineText == line.text, "The line " + line.number + '"' + lineText + '" should equal to ' +
            '"' + line.text + '"');
        ;
    });
})();
console.log("Testing Position & CharAt API");
(() => {
    let tm1 = new model_1.TextModel(testText1);
    for (let i = 0; i < testText1.length; i++) {
        assert.equal(tm1.charAt(tm1.positionAt(i)), testText1.charAt(i));
        assert.equal(tm1.offsetAt(tm1.positionAt(i)), i);
    }
})();
console.log("Report testing...");
(() => {
    let tm1 = new model_1.TextModel(testText1);
    let reportText = tm1.reportAll();
    assert(testText1 == reportText, "Report all should equal to the source");
    let firstLine = tm1.report({
        begin: {
            line: 1,
            offset: 0,
        },
        end: {
            line: 1,
            offset: 7,
        },
    });
    assert(tm1.lineAt(1).text == firstLine + '\n');
    let thatLines = tm1.report({
        begin: {
            line: 1,
            offset: 0,
        },
        end: {
            line: 3,
            offset: 1,
        }
    });
    assert("# Title\n\np");
})();
console.log("Inserting testing...");
(() => {
    let tm1 = new model_1.TextModel(testText1);
    tm1.insertText({ line: 1, offset: 0 }, "(insert)");
    assert(tm1.lineAt(1).text == "(insert)# Title\n");
    tm1.insertText({ line: 1, offset: 15 }, "(insert)");
    assert(tm1.lineAt(1).text == "(insert)# Title(insert)\n");
    tm1 = new model_1.TextModel(testText1);
    assert.throws(() => {
        tm1.insertText({ line: 0, offset: 0 }, "(insert)");
    }, Error);
    assert.throws(() => {
        tm1.insertText({ line: tm1.linesCount + 1, offset: 0 }, "insert");
    }, Error);
    assert.throws(() => {
        tm1.insertText({ line: 0, offset: tm1.lineAt(1).length }, "insert");
    }, Error);
    tm1 = new model_1.TextModel(testText1);
    tm1.insertText({ line: 4, offset: 9 }, "\n");
    assert(tm1.linesCount === 9);
    assert(tm1.lineAt(4).text == "something\n");
    assert(tm1.lineAt(5).text == " else\n");
    assert(tm1.lineAt(6).text == "\n");
    assert(tm1.lineAt(7).text == "- first line\n");
    assert(tm1.lineAt(8).text == "- second line\n");
    assert(tm1.lineAt(9).text == "- third line");
    tm1 = new model_1.TextModel(testText1);
    tm1.insertText({ line: 4, offset: 9 }, multilinesText);
    assert(tm1.linesCount === 10);
    assert(tm1.lineAt(4).text == "somethingmultilinesText\n");
    assert(tm1.lineAt(5).text == "total 3 lines\n");
    assert(tm1.lineAt(6).text == "last line. else\n");
    tm1 = new model_1.TextModel(testText1);
    tm1.insertText(tm1.positionAt(testText1.length - 1), "(insert)");
    assert(/(insert)/.test(tm1.lineAt(tm1.linesCount).text));
})();
console.log("Delect text testing...");
(() => {
    let tm1 = new model_1.TextModel(testText1);
    tm1.deleteText({
        begin: { line: 4, offset: 4 },
        end: { line: 4, offset: 9 }
    });
    assert(tm1.lineAt(4).text == "some else\n");
})();
console.log("All test done.");

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy90ZXN0L3RleHRNb2RlbFRlc3QudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLHdCQUFtQyxVQUNuQyxDQUFDLENBRDRDO0FBQzdDLE1BQU8sTUFBTSxXQUFXLFFBQVEsQ0FBQyxDQUFDO0FBR2xDLE1BQU0sU0FBUyxHQUNmOzs7Ozs7O2FBT2EsQ0FBQTtBQUViLE1BQU0sY0FBYyxHQUNwQjs7V0FFVyxDQUFBO0FBRVgsSUFBSSxVQUFVLEdBQUcsU0FBUyxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQztBQUN2QyxNQUFNLENBQUMsS0FBSyxDQUFDLFVBQVUsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxDQUFDLENBQUM7QUFHbkMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxzQkFBc0IsQ0FBQyxDQUFDO0FBQ3BDLENBQUM7SUFDRyxJQUFJLEdBQUcsR0FBRyxJQUFJLGlCQUFTLENBQUMsU0FBUyxDQUFDLENBQUM7SUFFbkMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxVQUFVLEtBQUssQ0FBQyxDQUFDLENBQUM7SUFFN0IsR0FBRyxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQWU7UUFDeEIsSUFBSSxRQUFRLEdBQVksVUFBVSxDQUFDLElBQUksQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDLENBQUM7UUFFcEQsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLE1BQU0sSUFBSSxHQUFHLENBQUMsVUFBVSxDQUFDO1lBQzlCLFFBQVEsSUFBSSxJQUFJLENBQUM7UUFDckIsTUFBTSxDQUFDLFFBQVEsSUFBSSxJQUFJLENBQUMsSUFBSSxFQUN4QixXQUFXLEdBQUcsSUFBSSxDQUFDLE1BQU0sR0FBRyxHQUFHLEdBQUcsUUFBUSxHQUFHLG9CQUFvQjtZQUNqRSxHQUFHLEdBQUcsSUFBSSxDQUFDLElBQUksR0FBRyxHQUFHLENBQUMsQ0FBQztRQUFBLENBQUM7SUFDaEMsQ0FBQyxDQUFDLENBQUM7QUFFUCxDQUFDLENBQUMsRUFBRSxDQUFDO0FBRUwsT0FBTyxDQUFD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QUM7SUFDaEQsTUFBTSxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxJQUFJLGNBQWMsQ0FBQyxDQUFDO0lBRTdDLEdBQUcsR0FBRyxJQUFJLGlCQUFTLENBQUMsU0FBUyxDQUFDLENBQUM7SUFDL0IsR0FBRyxDQUFDLFVBQVUsQ0FBQyxFQUFDLElBQUksRUFBRSxDQUFDLEVBQUUsTUFBTSxFQUFFLENBQUMsRUFBQyxFQUFFLGNBQWMsQ0FBQyxDQUFDO0lBQ3JELE1BQU0sQ0FBQyxHQUFHLENBQUMsVUFBVSxLQUFLLEVBQUUsQ0FBQyxDQUFDO0lBQzlCLE1BQU0sQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksSUFBSSwyQkFBMkIsQ0FBQyxDQUFDO0lBQzFELE1BQU0sQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksSUFBSSxpQkFBaUIsQ0FBQyxDQUFDO0lBQ2hELE1BQU0sQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksSUFBSSxtQkFBbUIsQ0FBQyxDQUFDO0lBR2xELEdBQUcsR0FBRyxJQUFJLGlCQUFTLENBQUMsU0FBUyxDQUFDLENBQUM7SUFDL0IsR0FBRyxDQUFDLFVBQVUsQ0FBQyxHQUFHLENBQUMsVUFBVSxDQUFDLFNBQVMsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDLEVBQUUsVUFBVSxDQUFDLENBQUM7SUFDakUsTUFBTSxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsVUFBVSxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQztBQUU3RCxDQUFDLENBQUMsRUFBRSxDQUFDO0FBRUwsT0FBTyxDQUFDLEdBQUcsQ0FBQyx3QkFBd0IsQ0FBQyxDQUFDO0FBQ3RDLENBQUM7SUFDRyxJQUFJLEdBQUcsR0FBRyxJQUFJLGlCQUFTLENBQUMsU0FBUyxDQUFDLENBQUM7SUFHbkMsR0FBRyxDQUFDLFVBQVUsQ0FBQztRQUNYLEtBQUssRUFBRSxFQUFDLElBQUksRUFBRSxDQUFDLEVBQUUsTUFBTSxFQUFFLENBQUMsRUFBQztRQUMzQixHQUFHLEVBQUUsRUFBQyxJQUFJLEVBQUUsQ0FBQyxFQUFFLE1BQU0sRUFBRSxDQUFDLEVBQUM7S0FDNUIsQ0FBQyxDQUFDO0lBRUgsTUFBTSxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxJQUFJLGFBQWEsQ0FBQyxDQUFBO0FBRS9DLENBQUMsQ0FBQyxFQUFFLENBQUM7QUFFTCxPQUFPLENBQUMsR0FBRyxDQUFDLGdCQUFnQixDQUFDLENBQUMiLCJmaWxlIjoidGVzdC90ZXh0TW9kZWxUZXN0LmpzIiwic291cmNlUm9vdCI6InNyYy8ifQ==
